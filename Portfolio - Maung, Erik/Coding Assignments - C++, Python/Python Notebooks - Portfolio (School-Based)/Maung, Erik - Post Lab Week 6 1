{"cells":[{"cell_type":"markdown","metadata":{"id":"J1ptZjJLZCI4"},"source":["# Your analysis\n","\n","Plot and fit your own data below "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":220,"status":"aborted","timestamp":1644552781118,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"thfTXHFcFZl4"},"outputs":[],"source":["# Import modules\n","from scipy.optimize import least_squares\n","import numpy as np\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":220,"status":"aborted","timestamp":1644552781118,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"IPWX36aeFcXd"},"outputs":[],"source":["# Mount google drive\n","from google.colab import drive\n","drive.mount('drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":220,"status":"aborted","timestamp":1644552781118,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"bodgXno4ZUCp"},"outputs":[],"source":["# Read in your data file\n","read_in_array = np.loadtxt('/content/drive/MyDrive/2021-2022/22Winter/4AL/Python References/2.8 Simple Harmonic Motion/09 SHM table.csv',skiprows=2,delimiter=',')\n","# Extract time\n","time = read_in_array[:,0]\n","# Extract position \n","position = read_in_array[:,1]\n","\n"]},{"cell_type":"markdown","metadata":{"id":"KCs1fYEeZhXz"},"source":["Below are the functions you need for the fit"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781119,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"A-dWUxj-ZaWw"},"outputs":[],"source":["def sin_fit_fun(parameters, time):\n","  a = parameters[0]\n","  omega = parameters[1]\n","  offset = parameters[2]\n","  phi = parameters[3]\n","  y = a * np.sin(omega * time + phi) + offset\n","  return y"]},{"cell_type":"markdown","metadata":{"id":"K2iRLe7dZpcS"},"source":["Plot your time vs position data"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781119,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"Ehmq3gsxZofu"},"outputs":[],"source":["# Make a plot\n","plt.plot(time, position, label='Object position')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Position (m)')\n","# Title\n","plt.title('SHM y-position vs time')\n","plt.legend()\n","\n"]},{"cell_type":"markdown","metadata":{"id":"5fxLRmUPZ1_B"},"source":["Clip your data so that the phase is approximately 0 and pick sufficient data to hold 3-4 oscillations"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781120,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"6HR4D8azZ9tu"},"outputs":[],"source":["# define your starting time\n","# define end time\n","start_time=1\n","time_window=time[start_time:94]\n","\n","# Clip your data\n","position_window=position[start_time:94]\n","\n","\n","# Make a plot\n","plt.plot(time_window, position_window, label='Object position')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Position (m)')\n","# Title\n","plt.title('SHM y-position vs time')\n","plt.legend()\n"]},{"cell_type":"markdown","metadata":{"id":"6MOWL6JkINsV"},"source":["Find your guess parameters"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781120,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"0A8P46X2ZkCy"},"outputs":[],"source":["# Make your guess parameters \n","\n","# Guess a\n","guess_a = 0.06\n","# guess omega\n","guess_omega = 8.3\n","# guess phi = 0.6\n","guess_phi = 1.2\n","# Guess offset\n","guess_offset = -0.07\n","guess_parameters = [guess_a,guess_omega,guess_offset,guess_phi]"]},{"cell_type":"markdown","metadata":{"id":"yoNbVrYcIQhF"},"source":["Compare your fit with the guess parameters to the data itself"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781120,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"Q51kOcqhGUr3"},"outputs":[],"source":["# Plot the original data and the fit with your guess parameters\n","theoretical_guess_function = sin_fit_fun(guess_parameters, time_window)\n","plt.plot(time_window, theoretical_guess_function, label='guess function')\n","# Make a plot\n","plt.plot(time_window, position_window, label='Object position')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Position (m)')\n","# Title\n","plt.title('SHM y-position vs time')\n","plt.legend()"]},{"cell_type":"markdown","metadata":{"id":"vMGK-nFEITLa"},"source":["Import least_squares and create the get_residuals() function"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":221,"status":"aborted","timestamp":1644552781121,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"RXU7k4sSGEob"},"outputs":[],"source":["# Run this to import least_squares\n","from scipy.optimize import least_squares"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781121,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"aD6cxRIoGZhO"},"outputs":[],"source":["def get_residuals(parameters, data, x):\n","  residuals = np.abs(data - sin_fit_fun(parameters, x))\n","  return -residuals"]},{"cell_type":"markdown","metadata":{"id":"9xBgSsDFIXNe"},"source":["Use least_squares to get the best possible parameters of fit."]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781122,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"XWiKckggag7G"},"outputs":[],"source":["# The imported least_squares function minimizes the residuals\n","res_lsq = least_squares(get_residuals, guess_parameters, args=(position_window,time_window))\n","\n","# We store the values of best possible paremeters obtained for amplitude, omega, offset and phase in best_parameters\n","best_parameters = res_lsq['x']"]},{"cell_type":"markdown","metadata":{"id":"NHvso6XLIa_I"},"source":["Print the best paramters."]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781122,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"WkN-twwAanMp"},"outputs":[],"source":["# Print out best parameters\n","print('Best Amplitude: ' + str(best_parameters[0]))\n","print('Best Omega: ' + str(best_parameters[1]))\n","print('Best offset: ' + str(best_parameters[2]))\n","print('Best Phi: ' + str(best_parameters[3]))"]},{"cell_type":"markdown","metadata":{"id":"QtjFavybIeJa"},"source":["Plot the best-fit sine function alongside the data."]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781122,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"dkptrEwqatLT"},"outputs":[],"source":["# Plot the fit\n","best_fit = sin_fit_fun(best_parameters, time_window)\n","plt.plot(time_window, best_fit, label='Best Fit')\n","# Plot the data\n","plt.scatter(time_window, position_window, label='Object position', color='orange')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Position (m)')\n","# Title\n","plt.title('SHM y-position vs time')\n","plt.legend()"]},{"cell_type":"markdown","metadata":{"id":"R8T-sx_cIiFX"},"source":["Since you now know the best parameters, use them to find the velocity vs time and the acceleration vs time."]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781123,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"dIoIC-XlIj3y"},"outputs":[],"source":["# The differentiation can be done by hand and then typed into code\n","# vel_fit is the velocity as a function of time\n","vel_fit = best_parameters[0]*best_parameters[1]*np.cos(best_parameters[1]*time_window+best_parameters[3])\n","# Plot the velocity vs time\n","plt.plot(time_window, vel_fit, label='Velocity Best Fit')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Velocity (m/s)')\n","# Title\n","plt.title('SHM velocity vs time')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781123,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"kSQzXlqiIj_h"},"outputs":[],"source":["# acc_fit is the acceleration as a function of time\n","acc_fit = -best_parameters[0]*(best_parameters[1]**2)*np.sin(best_parameters[1]*time_window+best_parameters[3])\n","# Plot the acceleration vs time \n","plt.plot(time_window, acc_fit, label='Acceleration Best Fit')\n","\n","# Axis labels\n","plt.xlabel('Time (s)')\n","plt.ylabel('Acceleration (m/s^2)')\n","# Title\n","plt.title('SHM acceleration vs time')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":11,"status":"aborted","timestamp":1644552781123,"user":{"displayName":"Erik Maung","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GimNaAVKWYsH3KcIqdQ31ty51QvAQUH2-PgGVu4pw=s64","userId":"00970732375403512107"},"user_tz":480},"id":"y3SXtdEDj-qx"},"outputs":[],"source":["# convert 50 grams -\u003e 0.050 kg\n","mass = 0.05\n","spring_constant = np.around(best_parameters[1]**2. * mass, 3)\n","print('The spring constant is ' + str(spring_constant) + ' N/m.')"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Maung, Erik - Post Lab Week 6 1","provenance":[{"file_id":"1imnJCMlTAErTH740etzBPHfQeVKJ6ddG","timestamp":1644552741627},{"file_id":"14jHsY-26xzrmZLw26kHV9UQ2Az_FreXF","timestamp":1644373055862},{"file_id":"1Sf8T5nT81FC5GRrO_72UsACRm_i8qCUz","timestamp":1644017526444},{"file_id":"1uxXQbMmW6yRA1cVX414nTBxNJ-r5zhvW","timestamp":1580346328490},{"file_id":"1snTn7T3Z_h4lR-Ux0diETRjpFmvfs2j6","timestamp":1565398815655}],"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}